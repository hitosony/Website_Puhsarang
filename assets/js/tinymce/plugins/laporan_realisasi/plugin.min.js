tinymce.PluginManager.add('laporan_realisasi', function( editor, url ) {
	editor.addButton( 'laporan_realisasi', {
		text: 'Lap Realisasi',
		icon: false,
		onclick: function() {
      var url = BASE_URL + "index.php/keuangan/cek_tahun";
      $.ajax({
        type: "GET",
        url: url,
        dataType: "json",
        processData: true,
        success: function (data) {          
          editor.windowManager.open( {
            title: 'Select Data Laporan Realisasi',
            body: [
              {
                type   : 'listbox',
                name   : 'semester',
                label  : 'Semester',
                values : [
                  { text: 'Semester 1', value: '1' },
                  { text: 'Semester 2', value: '2' }
                ],
                value : '1' 
              },
              {
                type   : 'listbox',
                name   : 'tahun',
                label  : 'Tahun',
                values : data,
              },
            ],
            onsubmit: function( e ) {
              editor.insertContent('[[lap-RP-APBD,' + e.data.semester +','+ e.data.tahun +']]');
            },
            width: 400,
            height: 140
          } )
        },
        error: function (xhr, status, error) {
            alert("Error! " + xhr.status + "\n" + error);
            console.log(xhr);
            console.log(base_url);
        }
      });			
		}
	});
});